<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ग्राम शक्ति - गाँव की डिजिटल सेवा | Gram Shakti Official</title>
<meta name="description" content="ग्राम शक्ति (Gram Shakti): आपके गाँव के सभी वर्कर्स, जेसीबी, मिस्त्री और मजदूरों को खोजने का सबसे बड़ा प्लेटफॉर्म।">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
  }
  .app-card {
    background: white; width: 100%; max-width: 480px; padding: 30px; border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1); z-index: 10;
  }
  .ad-space {
    width: 100%; max-width: 480px; background: rgba(0,0,0,0.05);
    border: 1px dashed #ccc; margin: 10px 0; display: flex;
    align-items: center; justify-content: center; color: #888;
    font-size: 12px; border-radius: 10px; min-height: 60px;
  }
  .btn-primary {
    width: 100%; padding: 16px; background: linear-gradient(90deg, #f97316, #ea580c);
    color: white; border-radius: 14px; font-size: 18px; font-weight: 700;
    margin-top: 15px; cursor: pointer; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  #adminLogo {
    background: #2563eb; color: white; width: 44px; height: 44px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: bold; cursor: pointer; 
  }
  .header-logo { font-family: 'Poppins', sans-serif; font-weight: 700; color: #f97316; font-size: 2rem; }
.back-btn {
    position: fixed;
    top: 15px;
    left: 10px;
    background: #2563eb;
    color: white;
    padding: 8px 15px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    font-size: 16px;
    font-weight: bold;
    z-index: 10000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
}

</style>
</head>
<body>
<button <a href="#" onclick="history.back(); return false;" class="back-btn">
    &#8592; Back
</a>
</button>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (1).png" alt="Gram Shakti App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>

  <div id="app-container" class="app-card">
    </div>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (2).png" alt="Install App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>
<script>
// Firebase Config (यहाँ आपका अपना पुराना वाला config कोड रहेगा)
const firebaseConfig = {
  apiKey: "AIzaSyCuvev3-jwZwQuO_fHYyv2E2ovLny4Lh8Q",
  authDomain: "gram-shakti-b135a.firebaseapp.com",
  databaseURL: "https://gram-shakti-b135a-default-rtdb.firebaseio.com",
  projectId: "gram-shakti-b135a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// डेटा स्टोर करने के लिए वेरिएबल
let userFlow = { state: '', jila: '', panchayat: '', village: '' };

// 1. बैक बटन का दिमाग
function goBack() {
    if (document.getElementById('distSelect') || document.getElementById('distInp')) {
        showStates();
    } else if (document.getElementById('panchSelect') || document.getElementById('panchInp')) {
        showDistrictStep();
    } else if (document.getElementById('villSelect') || document.getElementById('villInp')) {
        showPanchayatStep();
    } else {
        location.reload(); 
    }
}

// 2. मुख्य स्क्रीन - राज्यों की लिस्ट (इसे वापस ला दिया गया है)
function showStates() {
    const states = ['Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh', 'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand', 'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur', 'Meghalaya', 'Mizoram', 'Nagaland', 'Odisha', 'Punjab', 'Rajasthan', 'Sikkim', 'Tamil Nadu', 'Telangana', 'Tripura', 'Uttar Pradesh', 'Uttarakhand', 'West Bengal'];
    let container = document.getElementById('app-container');
    let html = `<h1 class="header-logo" style="text-align:center;">ग्राम शक्ति</h1><h3>अपना राज्य चुनें</h3><div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; max-height:300px; overflow-y:auto; padding:10px;">`;
    states.forEach(s => {
        html += `<div onclick="userFlow.state='${s}'; showDistrictStep()" style="border:1px solid #ccc; padding:10px; border-radius:8px; cursor:pointer; text-align:center; background:white;">${s}</div>`;
    });
    html += `</div>`;
    container.innerHTML = html;
}

// 3. जिला चुनने वाला फंक्शन
function showDistrictStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h3>अपना जिला चुनें (${userFlow.state})</h3>
        <select id="distSelect" class="dropdown-select" onchange="userFlow.jila = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- पुराना जिला चुनें --</option>
        </select>
        <div onclick="document.getElementById('distInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ मेरा जिला नया है (यहाँ लिखें)</div>
        <input type="text" id="distInp" placeholder="नये जिले का नाम लिखें" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="saveDistrict()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">आगे बढ़ें</button>`;

    db.ref('users/').once('value', (snapshot) => {
        let distSet = new Set();
        snapshot.forEach(child => { if(child.val().state === userFlow.state && child.val().jila) distSet.add(child.val().jila); });
        let select = document.getElementById('distSelect');
        distSet.forEach(d => { select.innerHTML += `<option value="${d}">${d}</option>`; });
    });
}

function saveDistrict() {
    let inp = document.getElementById('distInp').value;
    if(inp) userFlow.jila = inp; 
    if(!userFlow.jila) { alert("कृपया जिला चुनें या लिखें"); return; }
    showPanchayatStep();
}

// 4. पंचायत चुनने वाला फंक्शन
function showPanchayatStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h3>अपनी पंचायत चुनें (${userFlow.jila})</h3>
        <select id="panchSelect" class="dropdown-select" onchange="userFlow.panchayat = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- पुरानी पंचायत चुनें --</option>
        </select>
        <div onclick="document.getElementById('panchInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ मेरी पंचायत नई है (यहाँ लिखें)</div>
        <input type="text" id="panchInp" placeholder="नयी पंचायत का नाम लिखें" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="savePanchayat()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">आगे बढ़ें</button>`;

    db.ref('users/').once('value', (snapshot) => {
        let panchSet = new Set();
        snapshot.forEach(child => { 
            if(child.val().jila === userFlow.jila && child.val().panchayat) panchSet.add(child.val().panchayat); 
        });
        let select = document.getElementById('panchSelect');
        panchSet.forEach(p => { select.innerHTML += `<option value="${p}">${p}</option>`; });
    });
}

function savePanchayat() {
    let inp = document.getElementById('panchInp').value;
    if(inp) userFlow.panchayat = inp;
    if(!userFlow.panchayat) { alert("कृपया पंचायत चुनें या लिखें"); return; }
    showVillageStep();
}

// 5. गाँव चुनने वाला फंक्शन
function showVillageStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h3>अपना गाँव चुनें</h3>
        <select id="villSelect" class="dropdown-select" onchange="userFlow.village = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- पुराना गाँव चुनें --</option>
        </select>
        <div onclick="document.getElementById('villInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ मेरा गाँव नया है (यहाँ लिखें)</div>
        <input type="text" id="villInp" placeholder="नये गाँव का नाम लिखें" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="saveVillage()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">डाटा सुरक्षित करें</button>`;

    db.ref('users/').once('value', (snapshot) => {
        let villSet = new Set();
        snapshot.forEach(child => { 
            if(child.val().panchayat === userFlow.panchayat && child.val().village) villSet.add(child.val().village); 
        });
        let select = document.getElementById('villSelect');
        villSet.forEach(v => { select.innerHTML += `<option value="${v}">${v}</option>`; });
    });
}

function saveVillage() {
    let inp = document.getElementById('villInp').value;
    if(inp) userFlow.village = inp;
    if(!userFlow.village) { alert("कृपया गाँव चुनें या लिखें"); return; }
    saveData(); 
}

// 6. डेटा सेव फंक्शन
function saveData() {
    db.ref('users/').push(userFlow).then(() => {
        alert("सफलतापूर्वक सुरक्षित किया गया!");
        location.reload();
    });
}

// ऐप शुरू होते ही राज्यों को दिखाओ
showStates();
</script>
</body>
</html>
