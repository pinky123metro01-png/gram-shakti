<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø - ‡§ó‡§æ‡§Å‡§µ ‡§ï‡•Ä ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡•á‡§µ‡§æ | Gram Shakti Official</title>
<meta name="description" content="‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø (Gram Shakti): ‡§Ü‡§™‡§ï‡•á ‡§ó‡§æ‡§Å‡§µ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§µ‡§∞‡•ç‡§ï‡§∞‡•ç‡§∏, ‡§ú‡•á‡§∏‡•Ä‡§¨‡•Ä, ‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä ‡§î‡§∞ ‡§Æ‡§ú‡§¶‡•Ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡•ú‡§æ ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ‡•§">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
  }
  .app-card {
    background: white; width: 100%; max-width: 480px; padding: 30px; border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1); z-index: 10;
  }
  .ad-space {
    width: 100%; max-width: 480px; background: rgba(0,0,0,0.05);
    border: 1px dashed #ccc; margin: 10px 0; display: flex;
    align-items: center; justify-content: center; color: #888;
    font-size: 12px; border-radius: 10px; min-height: 60px;
  }
  .btn-primary {
    width: 100%; padding: 16px; background: linear-gradient(90deg, #f97316, #ea580c);
    color: white; border-radius: 14px; font-size: 18px; font-weight: 700;
    margin-top: 15px; cursor: pointer; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  #adminLogo {
    background: #2563eb; color: white; width: 44px; height: 44px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: bold; cursor: pointer; 
  }
  .header-logo { font-family: 'Poppins', sans-serif; font-weight: 700; color: #f97316; font-size: 2rem; }
.back-btn {
    position: fixed;
    top: 15px;
    left: 10px;
    background: #2563eb;
    color: white;
    padding: 8px 15px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    font-size: 16px;
    font-weight: bold;
    z-index: 10000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
}

</style>
</head>
<body>
<button <a href="#" onclick="history.back(); return false;" class="back-btn">
    &#8592; Back
</a>
</button>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (1).png" alt="Gram Shakti App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>

  <div id="app-container" class="app-card">
    </div>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (2).png" alt="Install App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>
<script>
// 1. ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤
let userFlow = {
    jila: '',
    panchayat: '',
    village: ''
};

// 2. ‡§¨‡•à‡§ï ‡§¨‡§ü‡§® ‡§ï‡§æ ‡§¶‡§ø‡§Æ‡§æ‡§ó (Step-by-Step ‡§™‡•Ä‡§õ‡•á ‡§ú‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)
function goBack() {
    if (document.getElementById('villSelect') || document.getElementById('villInp')) {
        showPanchayatStep();
    } else if (document.getElementById('panchSelect') || document.getElementById('panchInp')) {
        showDistrictStep();
    } else {
        location.reload(); 
    }
}

// 3. ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® (Drop-down ‡§ï‡•á ‡§∏‡§æ‡§•)
function showDistrictStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h1 class="header-logo" style="text-align:center;">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
        <h3>‡§Ö‡§™‡§®‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
        <select id="distSelect" class="dropdown-select" onchange="userFlow.jila = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
        </select>
        <div class="add-new-btn" onclick="document.getElementById('distInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ ‡§Æ‡•á‡§∞‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§®‡§Ø‡§æ ‡§π‡•à (‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç)</div>
        <input type="text" id="distInp" placeholder="‡§®‡§Ø‡•á ‡§ú‡§ø‡§≤‡•á ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="saveDistrict()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>`;

    // Firebase ‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§ú‡§ø‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ
    firebase.database().ref('users/').once('value', (snapshot) => {
        let distSet = new Set();
        snapshot.forEach(child => { if(child.val().jila) distSet.add(child.val().jila); });
        let select = document.getElementById('distSelect');
        distSet.forEach(d => { select.innerHTML += `<option value="${d}">${d}</option>`; });
    });
}

function saveDistrict() {
    let inp = document.getElementById('distInp').value;
    if(inp) userFlow.jila = inp; 
    if(!userFlow.jila) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç"); return; }
    showPanchayatStep();
}

// 4. ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡•Å‡§®‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function showPanchayatStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h3>‡§Ö‡§™‡§®‡•Ä ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
        <select id="panchSelect" class="dropdown-select" onchange="userFlow.panchayat = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
        </select>
        <div class="add-new-btn" onclick="document.getElementById('panchInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ ‡§Æ‡•á‡§∞‡•Ä ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§®‡§à ‡§π‡•à (‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç)</div>
        <input type="text" id="panchInp" placeholder="‡§®‡§Ø‡•Ä ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="savePanchayat()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>`;

    firebase.database().ref('users/').once('value', (snapshot) => {
        let panchSet = new Set();
        snapshot.forEach(child => { 
            if(child.val().jila === userFlow.jila && child.val().panchayat) panchSet.add(child.val().panchayat); 
        });
        let select = document.getElementById('panchSelect');
        panchSet.forEach(p => { select.innerHTML += `<option value="${p}">${p}</option>`; });
    });
}

function savePanchayat() {
    let inp = document.getElementById('panchInp').value;
    if(inp) userFlow.panchayat = inp;
    if(!userFlow.panchayat) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç"); return; }
    showVillageStep();
}

// 5. ‡§ó‡§æ‡§Å‡§µ ‡§ö‡•Å‡§®‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function showVillageStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <h3>‡§Ö‡§™‡§®‡§æ ‡§ó‡§æ‡§Å‡§µ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
        <select id="villSelect" class="dropdown-select" onchange="userFlow.village = this.value" style="width:90%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;">
            <option value="">-- ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§ó‡§æ‡§Å‡§µ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
        </select>
        <div class="add-new-btn" onclick="document.getElementById('villInp').style.display='block'; this.style.display='none'" style="cursor:pointer; color:blue; font-size:13px; margin-bottom:10px;">+ ‡§Æ‡•á‡§∞‡§æ ‡§ó‡§æ‡§Å‡§µ ‡§®‡§Ø‡§æ ‡§π‡•à (‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç)</div>
        <input type="text" id="villInp" placeholder="‡§®‡§Ø‡•á ‡§ó‡§æ‡§Å‡§µ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="display:none; width:85%; padding:10px; margin:10px auto; border-radius:8px; border:1px solid #ccc;">
        <button onclick="saveVillage()" class="btn" style="width:90%; padding:12px; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; font-weight:bold;">‡§°‡§æ‡§ü‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç</button>`;

    firebase.database().ref('users/').once('value', (snapshot) => {
        let villSet = new Set();
        snapshot.forEach(child => { 
            if(child.val().panchayat === userFlow.panchayat && child.val().village) villSet.add(child.val().village); 
        });
        let select = document.getElementById('villSelect');
        villSet.forEach(v => { select.innerHTML += `<option value="${v}">${v}</option>`; });
    });
}

function saveVillage() {
    let inp = document.getElementById('villInp').value;
    if(inp) userFlow.village = inp;
    if(!userFlow.village) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§ó‡§æ‡§Å‡§µ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç"); return; }
    save(); // ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•á ‡§Ö‡§∏‡§≤‡•Ä ‡§∏‡•á‡§µ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ
}

function save() {
  const name = document.getElementById("n").value;
  const ph = document.getElementById("p").value;
  const wk = document.getElementById("w").value;
  db.ref("workers").push({
    name, phone: ph, work: wk,
    location: `${userFlow.state}/${userFlow.district}/${userFlow.panchayat}/${userFlow.village}`
  }).then(() => { alert("‡§∏‡§´‡§≤!"); showOptions(); });
}

function showView() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-4">‡§ó‡§æ‡§Å‡§µ ‡§ï‡•Ä ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <div id="list" class="space-y-3 max-h-[300px] overflow-y-auto"></div>
    <button onclick="showOptions()" class="mt-4 text-gray-400 text-sm w-full">‡§™‡•Ä‡§õ‡•á ‡§ú‡§æ‡§è‡§Å</button>
  `;
  const path = `${userFlow.state}/${userFlow.district}/${userFlow.panchayat}/${userFlow.village}`;
  db.ref("workers").on("value", snap => {
    let h = "";
    snap.forEach(c => {
      const d = c.val();
      if(d.location === path) h += `<div class="p-3 border rounded-xl flex justify-between items-center shadow-sm">
        <div><p class="font-bold">${d.name}</p><p class="text-orange-600 text-sm">${d.work}</p></div>
        <a href="tel:${d.phone}" class="bg-green-500 text-white p-2 rounded-full">üìû</a>
      </div>`;
    });
    document.getElementById("list").innerHTML = h || "‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ";
  });
}

function showAdmin() {
  document.getElementById("app-container").innerHTML = `<h2 class="text-xl font-bold mb-4">Admin</h2><div id="al" class="space-y-2"></div>`;
  db.ref("workers").on("value", snap => {
    let h = "";
    snap.forEach(c => { h += `<div class="p-2 border flex justify-between text-xs">${c.val().name} <button onclick="db.ref('workers/${c.key}').remove()" class="text-red-500">Del</button></div>`; });
    document.getElementById("al").innerHTML = h;
  });
}

showStates();
</script>
</body>
</html>
