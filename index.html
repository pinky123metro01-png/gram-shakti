<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>рдЧреНрд░рд╛рдо рд╢рдХреНрддрд┐ - рдЧрд╛рдБрд╡ рдХреА рдбрд┐рдЬрд┐рдЯрд▓ рд╕реЗрд╡рд╛ | Gram Shakti Official</title>
<meta name="description" content="рдЧреНрд░рд╛рдо рд╢рдХреНрддрд┐ (Gram Shakti): рдЖрдкрдХреЗ рдЧрд╛рдБрд╡ рдХреЗ рд╕рднреА рд╡рд░реНрдХрд░реНрд╕, рдЬреЗрд╕реАрдмреА, рдорд┐рд╕реНрддреНрд░реА рдФрд░ рдордЬрджреВрд░реЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдмреЬрд╛ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдоред">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
  }
  .app-card {
    background: white; width: 100%; max-width: 480px; padding: 30px; border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1); z-index: 10;
  }
  .ad-space {
    width: 100%; max-width: 480px; background: rgba(0,0,0,0.05);
    border: 1px dashed #ccc; margin: 10px 0; display: flex;
    align-items: center; justify-content: center; color: #888;
    font-size: 12px; border-radius: 10px; min-height: 60px;
  }
  .btn-primary {
    width: 100%; padding: 16px; background: linear-gradient(90deg, #f97316, #ea580c);
    color: white; border-radius: 14px; font-size: 18px; font-weight: 700;
    margin-top: 15px; cursor: pointer; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  #adminLogo {
    background: #2563eb; color: white; width: 44px; height: 44px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: bold; cursor: pointer; 
  }
  .header-logo { font-family: 'Poppins', sans-serif; font-weight: 700; color: #f97316; font-size: 2rem; }
.back-btn {
    position: fixed;
    top: 15px;
    left: 10px;
    background: #2563eb;
    color: white;
    padding: 8px 15px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    font-size: 16px;
    font-weight: bold;
    z-index: 10000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
}

</style>
</head>
<body>
<button class="back-btn" onclick="goBack()">
    &#8592; Back
</button>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (1).png" alt="Gram Shakti App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>

  <div id="app-container" class="app-card">
    </div>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (2).png" alt="Install App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>
<script>
// 1. Firebase рд╕реЗрдЯрдЕрдк
const firebaseConfig = {
  apiKey: "AIzaSyCuvev3-jwZwQuO_fHYyv2E2ovLny4Lh8Q",
  authDomain: "gram-shakti-b135a.firebaseapp.com",
  databaseURL: "https://gram-shakti-b135a-default-rtdb.firebaseio.com",
  projectId: "gram-shakti-b135a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let userFlow = { state: '', jila: '', panchayat: '', village: '', role: '', service: '', delCharge: '', serviceAreas: [] };

// 2. рдмреИрдХ рдмрдЯрди - рдЬреЛ рд╣рд░ рдХрджрдо рдкрд░ рд╕рд╛рде рджреЗрдЧрд╛
function goBack() {
    console.log("Back button clicked"); // рдЗрд╕рд╕реЗ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ рдмрдЯрди рджрдм рд░рд╣рд╛ рд╣реИ

    // 1. рдЕрдЧрд░ рд▓рд┐рд╕реНрдЯ рдпрд╛ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди рдлреЙрд░реНрдо рдкрд░ рд╣реИрдВ, рддреЛ рд╕рд░реНрд╡рд┐рд╕ рд▓рд┐рд╕реНрдЯ рдкрд░ рдЬрд╛рдПрдБ
    if (document.getElementById('list-container') || document.getElementById('reg-form')) {
        showServiceList();
    } 
    // 2. рдЕрдЧрд░ рд╕рд░реНрд╡рд┐рд╕ рд▓рд┐рд╕реНрдЯ рдкрд░ рд╣реИрдВ, рддреЛ рд░реЛрд▓ рд╕рд┐рд▓реЗрдХреНрд╢рди (Worker/Customer) рдкрд░ рдЬрд╛рдПрдБ
    else if (document.getElementById('service-list-page')) {
        showRoleSelection();
    } 
    // 3. рдЕрдЧрд░ рд░реЛрд▓ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рд╣реИрдВ, рддреЛ рдЧрд╛рдБрд╡ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рдЬрд╛рдПрдБ
    else if (document.getElementById('role-page')) {
        showVillageStep();
    } 
    // 4. рдЕрдЧрд░ рдЧрд╛рдБрд╡ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рд╣реИрдВ, рддреЛ рдкрдВрдЪрд╛рдпрдд рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рдЬрд╛рдПрдБ
    else if (document.getElementById('vill-page')) {
        showPanchayatStep();
    } 
    // 5. рдЕрдЧрд░ рдкрдВрдЪрд╛рдпрдд рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рд╣реИрдВ, рддреЛ рдЬрд┐рд▓рд╛ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рдЬрд╛рдПрдБ
    else if (document.getElementById('panch-page')) {
        showDistrictStep();
    } 
    // 6. рдЕрдЧрд░ рдЬрд┐рд▓рд╛ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рд╣реИрдВ, рддреЛ рд░рд╛рдЬреНрдпреЛрдВ (Home) рдкрд░ рдЬрд╛рдПрдБ
    else if (document.getElementById('dist-page')) {
        showStates();
    } 
    // 7. рдЕрдЧрд░ рд░рд╛рдЬреНрдпреЛрдВ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдкрд░ рд╣реИрдВ, рддреЛ рдРрдк рд░реАрд▓реЛрдб рдХрд░реЗрдВ
    else {
        location.reload();
    }
}


// 3. 10 рд░рд╛рдЬреНрдпреЛрдВ рдХрд╛ рд╢рд╛рдирджрд╛рд░ Dual-Tone рдбрд┐рдЬрд╛рдЗрди
function showStates() {
    const states = [
        {name: 'Uttar Pradesh', em: 'ЁЯПа'}, {name: 'Bihar', em: 'ЁЯМ╛'}, 
        {name: 'Rajasthan', em: 'ЁЯП░'}, {name: 'Madhya Pradesh', em: 'ЁЯМ│'}, 
        {name: 'Haryana', em: 'ЁЯеЫ'}, {name: 'Jharkhand', em: 'тЫПя╕П'},
        {name: 'Uttarakhand', em: 'ЁЯПФя╕П'}, {name: 'Chhattisgarh', em: 'ЁЯЪЬ'},
        {name: 'Punjab', em: 'ЁЯМ╛'}, {name: 'Delhi', em: 'ЁЯПЫя╕П'}
    ];
    
    let html = `
        <div id="state-page" style="padding:15px; text-align:center;">
            <h1 style="color:#f97316; font-size:32px; margin-bottom:5px;">рдЧреНрд░рд╛рдо рд╢рдХреНрддрд┐</h1>
            <p style="margin-bottom:20px; font-weight:bold; color:#555;">рдЕрдкрдирд╛ рд░рд╛рдЬреНрдп рдЪреБрдиреЗрдВ</p>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">`;
            
    states.forEach(s => {
        html += `
            <div onclick="userFlow.state='${s.name}'; showDistrictStep()" 
                 style="border-radius:15px; overflow:hidden; box-shadow:0 8px 15px rgba(0,0,0,0.1); cursor:pointer; background:white;">
                <div style="background: #f97316; padding:25px; font-size:40px;">${s.em}</div>
                <div style="background: #000000; color: white; padding:12px; font-weight:bold; font-size:14px;">${s.name}</div>
            </div>`;
    });
    
    html += `</div></div>`;
    document.getElementById('app-container').innerHTML = html;
}

// 4. рдЬрд┐рд▓рд╛ рдЪрдпрди (Firebase рд╕реЗ рдСрдЯреЛ-рд▓реЛрдб)
function showDistrictStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div id="dist-page" style="padding:20px;">
            <h3 style="color:#f97316;">${userFlow.state}</h3>
            <p>рдЬрд┐рд▓рд╛ рдЪреБрдиреЗрдВ рдпрд╛ рдирдпрд╛ рд▓рд┐рдЦреЗрдВ:</p>
            <select id="distSelect" style="width:100%; padding:15px; border-radius:12px; border:2px solid #f97316; margin:15px 0;">
                <option value="">-- рдкреБрд░рд╛рдиреЗ рдЬрд┐рд▓реЗ --</option>
            </select>
            <input type="text" id="distInp" placeholder="+ рдирдпрд╛ рдЬрд┐рд▓рд╛ рдЬреЛреЬреЗрдВ" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ccc;">
            <button onclick="saveDistrict()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:20px;">рдЖрдЧреЗ рдмреЭреЗрдВ</button>
        </div>`;
    
    db.ref('users/').once('value', snap => {
        let set = new Set();
        snap.forEach(c => { if(c.val().state === userFlow.state) set.add(c.val().jila); });
        let sel = document.getElementById('distSelect');
        set.forEach(d => { if(d) sel.innerHTML += `<option value="${d}">${d}</option>`; });
    });
}
function saveDistrict() {
    userFlow.jila = document.getElementById('distInp').value || document.getElementById('distSelect').value;
    if(!userFlow.jila) { alert("рдЬрд┐рд▓рд╛ рдЪреБрдиреЗрдВ рдпрд╛ рд▓рд┐рдЦреЗрдВ"); return; }
    showPanchayatStep();
}

// 5. рдкрдВрдЪрд╛рдпрдд рдЪрдпрди (Firebase рд╕реЗ рдСрдЯреЛ-рд▓реЛрдб)
function showPanchayatStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div id="panch-page" style="padding:20px;">
            <h3 style="color:#f97316;">${userFlow.jila}</h3>
            <p>рдкрдВрдЪрд╛рдпрдд рдЪреБрдиреЗрдВ рдпрд╛ рдирдИ рд▓рд┐рдЦреЗрдВ:</p>
            <select id="panchSelect" style="width:100%; padding:15px; border-radius:12px; border:2px solid #f97316; margin:15px 0;">
                <option value="">-- рдкреБрд░рд╛рдиреА рдкрдВрдЪрд╛рдпрддреЗрдВ --</option>
            </select>
            <input type="text" id="panchInp" placeholder="+ рдирдИ рдкрдВрдЪрд╛рдпрдд рдЬреЛреЬреЗрдВ" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ccc;">
            <button onclick="savePanchayat()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:20px;">рдЖрдЧреЗ рдмреЭреЗрдВ</button>
        </div>`;
    
    db.ref('users/').once('value', snap => {
        let set = new Set();
        snap.forEach(c => { if(c.val().jila === userFlow.jila) set.add(c.val().panchayat); });
        let sel = document.getElementById('panchSelect');
        set.forEach(p => { if(p) sel.innerHTML += `<option value="${p}">${p}</option>`; });
    });
}
function savePanchayat() {
    userFlow.panchayat = document.getElementById('panchInp').value || document.getElementById('panchSelect').value;
    if(!userFlow.panchayat) { alert("рдкрдВрдЪрд╛рдпрдд рд▓рд┐рдЦреЗрдВ"); return; }
    showVillageStep();
}

// 6. рдЧрд╛рдБрд╡ рдЪрдпрди (Firebase рд╕реЗ рдСрдЯреЛ-рд▓реЛрдб рдФрд░ рдирдпрд╛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк)
function showVillageStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div id="vill-page" style="padding:20px;">
            <h3 style="color:#f97316;">${userFlow.panchayat} > рдЧрд╛рдБрд╡</h3>
            <p style="margin-bottom:10px; font-weight:bold;">рдЕрдкрдирд╛ рдЧрд╛рдБрд╡ рдЪреБрдиреЗрдВ рдпрд╛ рдирдпрд╛ рд▓рд┐рдЦреЗрдВ:</p>
            
            <select id="villSelect" style="width:100%; padding:15px; border-radius:12px; border:2px solid #f97316; margin-bottom:15px; font-size:16px;">
                <option value="">-- рдкреБрд░рд╛рдиреЗ рдЧрд╛рдБрд╡ рдЪреБрдиреЗрдВ --</option>
            </select>

            <div onclick="document.getElementById('villInp').style.display='block'; this.style.display='none'" 
                 style="color:#2563eb; margin-bottom:15px; cursor:pointer; font-weight:bold;">
                 + рдирдпрд╛ рдЧрд╛рдБрд╡ рдЬреЛреЬреЗрдВ
            </div>
            
            <input type="text" id="villInp" placeholder="рдпрд╣рд╛рдБ рдЧрд╛рдБрд╡ рдХрд╛ рдирд╛рдо рд▓рд┐рдЦреЗрдВ" 
                   style="display:none; width:100%; padding:15px; border-radius:12px; border:1px solid #ccc; margin-bottom:15px;">

            <button onclick="saveVillage()" 
                    style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; font-size:18px;">
                    рдЖрдЧреЗ рдмреЭреЗрдВ
            </button>
        </div>`;

    // Firebase рд╕реЗ рдЧрд╛рдБрд╡ рд▓реЛрдб рдХрд░рдирд╛
    db.ref('users/').once('value', snap => {
        let set = new Set();
        snap.forEach(c => { 
            let d = c.val();
            if(d.panchayat === userFlow.panchayat) { set.add(d.village); }
        });
        let sel = document.getElementById('villSelect');
        set.forEach(v => { if(v) sel.innerHTML += `<option value="${v}">${v}</option>`; });
    });
}

function saveVillage() {
    let val = document.getElementById('villInp').value || document.getElementById('villSelect').value;
    if(!val) { alert("рдЧрд╛рдБрд╡ рдЪреБрдиреЗрдВ рдпрд╛ рд▓рд┐рдЦреЗрдВ"); return; }
    userFlow.village = val;
    showRoleSelection();
}


function showRoleSelection() {
    document.getElementById('app-container').innerHTML = `
        <div id="role-page" style="padding:25px; text-align:center;">
            <div onclick="userFlow.role='worker'; showServiceList()" style="background:#2563eb; color:white; padding:30px; border-radius:20px; margin-bottom:20px; font-weight:bold; font-size:20px; box-shadow:0 10px 20px rgba(0,0,0,0.1);">рдореИрдВ рд╡рд░реНрдХрд░/рджреБрдХрд╛рдирджрд╛рд░ рд╣реВрдБ</div>
            <div onclick="userFlow.role='customer'; showServiceList()" style="background:#16a34a; color:white; padding:30px; border-radius:20px; font-weight:bold; font-size:20px; box-shadow:0 10px 20px rgba(0,0,0,0.1);">рдореБрдЭреЗ рд╡рд░реНрдХрд░ рдЪрд╛рд╣рд┐рдП</div>
        </div>`;
}

function showServiceList() {
    const srv = ['рдбреЗрдпрд░реА/рджреВрдз', 'рдХрд┐рд░рд╛рдирд╛ рджреБрдХрд╛рди', 'рдорд┐рд╕реНрддреНрд░реА', 'JCB рдорд╢реАрди', 'рдЯреНрд░реИрдХреНрдЯрд░', 'рдЗрд▓реЗрдХреНрдЯреНрд░реАрд╢рд┐рдпрди', 'рдореЫрджреВрд░', 'рдЯреЗрд▓рд░', 'рдореИрдХреЗрдирд┐рдХ'];
    let html = `<div id="service-list-page" style="padding:15px;"><div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">`;
    srv.forEach(s => {
        html += `<div onclick="userFlow.service='${s}'; ${userFlow.role==='worker'?'showRegistrationForm()':'showList()'}" style="background:white; padding:20px; border-radius:15px; text-align:center; font-weight:bold; border-bottom:4px solid #000; box-shadow:0 4px 8px rgba(0,0,0,0.1); cursor:pointer;">${s}</div>`;
    });
    document.getElementById('app-container').innerHTML = html + `</div></div>`;
}

// 7. рд╡рд░реНрдХрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди (рдбрд┐рд▓реАрд╡рд░реА рдЪрд╛рд░реНрдЬ рдХреЗ рд╕рд╛рде)
function showRegistrationForm() {
    let isShop = (userFlow.service === 'рдбреЗрдпрд░реА/рджреВрдз' || userFlow.service === 'рдХрд┐рд░рд╛рдирд╛ рджреБрдХрд╛рди');
    document.getElementById('app-container').innerHTML = `
        <div id="reg-form" style="padding:20px;">
            <div style="background:white; border-radius:20px; box-shadow:0 10px 20px rgba(0,0,0,0.1); padding:20px;">
                <h3 style="color:#2563eb;">${userFlow.service} рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди</h3>
                <input type="text" id="wName" placeholder="рдирд╛рдо / рджреБрдХрд╛рди рдХрд╛ рдирд╛рдо" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd;">
                <input type="number" id="wPhone" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd;">
                ${isShop ? `<input type="text" id="wCharge" placeholder="рдбрд┐рд▓реАрд╡рд░реА рдЪрд╛рд░реНрдЬ (рдЬреИрд╕реЗ тВ╣20)" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd; background:#fff9db;">` : ''}
                <textarea id="wAreas" placeholder="рдЕрдиреНрдп рдЧрд╛рдБрд╡реЛрдВ рдХреЗ рдирд╛рдо (рдХреЛрдорд╛ , рд▓рдЧрд╛рдХрд░)" style="width:100%; height:70px; padding:12px; border-radius:10px; border:1px solid #ddd;"></textarea>
                <button onclick="finalRegister()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:15px;">рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ</button>
            </div>
        </div>`;
}

function finalRegister() {
    userFlow.workerName = document.getElementById('wName').value;
    userFlow.workerPhone = document.getElementById('wPhone').value;
    userFlow.delCharge = document.getElementById('wCharge') ? document.getElementById('wCharge').value : 'NA';
    let areas = document.getElementById('wAreas').value;
    if(!userFlow.workerName || !userFlow.workerPhone) { alert("рдирд╛рдо рдФрд░ рдирдВрдмрд░ рднрд░реЗрдВ"); return; }
    userFlow.serviceAreas = areas.split(',').map(i => i.trim().toLowerCase());
    userFlow.serviceAreas.push(userFlow.village.toLowerCase());
    db.ref('users/').push(userFlow).then(() => { alert("рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди рд╕рдлрд▓!"); location.reload(); });
}

// 8. рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ
function showList() {
    document.getElementById('app-container').innerHTML = `<div id="list-container" style="padding:15px;"><h3>${userFlow.service} рд▓рд┐рд╕реНрдЯ</h3><div id="list-box">рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div></div>`;
    db.ref('users/').once('value', snap => {
        let html = ''; let found = false;
        let v = userFlow.village.toLowerCase();
        snap.forEach(child => {
            let d = child.val();
            if(d.role === 'worker' && d.service === userFlow.service && d.serviceAreas && d.serviceAreas.includes(v)) {
                html += `<div style="background:white; padding:15px; border-radius:15px; margin-bottom:12px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 5px 10px rgba(0,0,0,0.1); border-left:6px solid #16a34a;">
                    <div><b>${d.workerName}</b><br><small>${d.delCharge!=='NA'?'ЁЯЪЪ рдЪрд╛рд░реНрдЬ: '+d.delCharge : 'рдЧрд╛рдБрд╡: '+d.village}</small></div>
                    <a href="tel:${d.workerPhone}" style="background:#16a34a; color:white; width:45px; height:45px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none;">ЁЯУЮ</a>
                </div>`;
                found = true;
            }
        });
        document.getElementById('list-box').innerHTML = found ? html : "рдХреЛрдИ рдирд╣реАрдВ рдорд┐рд▓рд╛ред";
    });
}

// рдРрдк рд╕реНрдЯрд╛рд░реНрдЯ
showStates();
</script>
