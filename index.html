<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø - ‡§ó‡§æ‡§Å‡§µ ‡§ï‡•Ä ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡•á‡§µ‡§æ | Gram Shakti Official</title>
<meta name="description" content="‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø (Gram Shakti): ‡§Ü‡§™‡§ï‡•á ‡§ó‡§æ‡§Å‡§µ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§µ‡§∞‡•ç‡§ï‡§∞‡•ç‡§∏, ‡§ú‡•á‡§∏‡•Ä‡§¨‡•Ä, ‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä ‡§î‡§∞ ‡§Æ‡§ú‡§¶‡•Ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡•ú‡§æ ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ‡•§">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
  }
  .app-card {
    background: white; width: 100%; max-width: 480px; padding: 30px; border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1); z-index: 10;
  }
  .ad-space {
    width: 100%; max-width: 480px; background: rgba(0,0,0,0.05);
    border: 1px dashed #ccc; margin: 10px 0; display: flex;
    align-items: center; justify-content: center; color: #888;
    font-size: 12px; border-radius: 10px; min-height: 60px;
  }
  .btn-primary {
    width: 100%; padding: 16px; background: linear-gradient(90deg, #f97316, #ea580c);
    color: white; border-radius: 14px; font-size: 18px; font-weight: 700;
    margin-top: 15px; cursor: pointer; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  #adminLogo {
    background: #2563eb; color: white; width: 44px; height: 44px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: bold; cursor: pointer; 
  }
  .header-logo { font-family: 'Poppins', sans-serif; font-weight: 700; color: #f97316; font-size: 2rem; }
.back-btn {
    position: fixed;
    top: 15px;
    left: 10px;
    background: #2563eb;
    color: white;
    padding: 8px 15px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    font-size: 16px;
    font-weight: bold;
    z-index: 10000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
}

</style>
</head>
<body>
<button <a href="#" onclick="history.back(); return false;" class="back-btn">
    &#8592; Back
</a>
</button>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (1).png" alt="Gram Shakti App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>

  <div id="app-container" class="app-card">
    </div>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (2).png" alt="Install App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>
<script>
// 1. Firebase ‡§∏‡•á‡§ü‡§Ö‡§™
const firebaseConfig = {
  apiKey: "AIzaSyCuvev3-jwZwQuO_fHYyv2E2ovLny4Lh8Q",
  authDomain: "gram-shakti-b135a.firebaseapp.com",
  databaseURL: "https://gram-shakti-b135a-default-rtdb.firebaseio.com",
  projectId: "gram-shakti-b135a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let userFlow = { state: '', jila: '', panchayat: '', village: '', role: '', service: '', delCharge: '', serviceAreas: [] };

// 2. ‡§¨‡•à‡§ï ‡§¨‡§ü‡§® - ‡§ú‡•ã ‡§π‡§∞ ‡§™‡•á‡§ú ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ
function goBack() {
    if (document.getElementById('list-container') || document.getElementById('reg-form')) showServiceList();
    else if (document.getElementById('service-list-page')) showRoleSelection();
    else if (document.getElementById('role-page')) showVillageStep();
    else if (document.getElementById('vill-page')) showPanchayatStep();
    else if (document.getElementById('panch-page')) showDistrictStep();
    else if (document.getElementById('dist-page')) showStates();
    else location.reload();
}

// 3. ‡§∞‡§æ‡§ú‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§°‡§ø‡§ú‡§æ‡§á‡§® (Orange Top, Black Bottom)
function showStates() {
    const states = [
        {name: 'Uttar Pradesh', em: 'üè†'}, {name: 'Bihar', em: 'üåæ'}, 
        {name: 'Rajasthan', em: 'üè∞'}, {name: 'Madhya Pradesh', em: 'üå≥'}, 
        {name: 'Haryana', em: 'ü•õ'}, {name: 'Jharkhand', em: '‚õèÔ∏è'}
    ];
    let html = `<div id="state-page" style="padding:15px; text-align:center;">
        <h1 style="color:#f97316; font-size:32px;">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
        <p style="margin-bottom:20px; font-weight:bold;">‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</p>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">`;
    states.forEach(s => {
        html += `<div onclick="userFlow.state='${s.name}'; showDistrictStep()" style="border-radius:15px; overflow:hidden; box-shadow:0 8px 15px rgba(0,0,0,0.1); cursor:pointer; background:white;">
            <div style="background:#f97316; padding:25px; font-size:40px;">${s.em}</div>
            <div style="background:#000; color:white; padding:12px; font-weight:bold;">${s.name}</div>
        </div>`;
    });
    document.getElementById('app-container').innerHTML = html + `</div></div>`;
}

// 4. ‡§ú‡§ø‡§≤‡§æ ‡§ö‡§Ø‡§®
function showDistrictStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `<div id="dist-page" style="padding:20px;">
        <h3 style="color:#f97316;">${userFlow.state}</h3>
        <select id="distSelect" style="width:100%; padding:15px; border-radius:12px; border:2px solid #f97316; margin:15px 0;">
            <option value="">-- ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
        </select>
        <input type="text" id="distInp" placeholder="+ ‡§®‡§Ø‡§æ ‡§ú‡§ø‡§≤‡§æ ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ccc;">
        <button onclick="saveDistrict()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:20px;">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>
    </div>`;
    db.ref('users/').once('value', snap => {
        let set = new Set(); snap.forEach(c => { if(c.val().state === userFlow.state) set.add(c.val().jila); });
        set.forEach(d => { if(d) document.getElementById('distSelect').innerHTML += `<option value="${d}">${d}</option>`; });
    });
}
function saveDistrict() { 
    userFlow.jila = document.getElementById('distInp').value || document.getElementById('distSelect').value;
    if(!userFlow.jila) { alert("‡§ú‡§ø‡§≤‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç"); return; } showPanchayatStep(); 
}

// 5. ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡§Ø‡§®
function showPanchayatStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `<div id="panch-page" style="padding:20px;">
        <h3 style="color:#f97316;">${userFlow.jila}</h3>
        <select id="panchSelect" style="width:100%; padding:15px; border-radius:12px; border:2px solid #f97316; margin:15px 0;">
            <option value="">-- ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
        </select>
        <input type="text" id="panchInp" placeholder="+ ‡§®‡§à ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ccc;">
        <button onclick="savePanchayat()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:20px;">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>
    </div>`;
    db.ref('users/').once('value', snap => {
        let set = new Set(); snap.forEach(c => { if(c.val().jila === userFlow.jila) set.add(c.val().panchayat); });
        set.forEach(p => { if(p) document.getElementById('panchSelect').innerHTML += `<option value="${p}">${p}</option>`; });
    });
}
function savePanchayat() { 
    userFlow.panchayat = document.getElementById('panchInp').value || document.getElementById('panchSelect').value;
    if(!userFlow.panchayat) { alert("‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§≤‡§ø‡§ñ‡•á‡§Ç"); return; } showVillageStep(); 
}

// 6. ‡§ó‡§æ‡§Å‡§µ, ‡§∞‡•ã‡§≤ ‡§î‡§∞ ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏
function showVillageStep() {
    document.getElementById('app-container').innerHTML = `<div id="vill-page" style="padding:20px;">
        <h3>‡§ó‡§æ‡§Å‡§µ ‡§ï‡§æ ‡§®‡§æ‡§Æ</h3>
        <input type="text" id="villInp" placeholder="‡§ó‡§æ‡§Å‡§µ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ccc; margin:20px 0;">
        <button onclick="userFlow.village=document.getElementById('villInp').value; if(!userFlow.village)return; showRoleSelection()" style="width:100%; padding:18px; background:#000; color:white; border-radius:15px; font-weight:bold;">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>
    </div>`;
}

function showRoleSelection() {
    document.getElementById('app-container').innerHTML = `<div id="role-page" style="padding:25px; text-align:center;">
        <div onclick="userFlow.role='worker'; showServiceList()" style="background:#2563eb; color:white; padding:30px; border-radius:20px; margin-bottom:20px; font-weight:bold; font-size:20px;">‡§Æ‡•à‡§Ç ‡§µ‡§∞‡•ç‡§ï‡§∞/‡§¶‡•Å‡§ï‡§æ‡§®‡§¶‡§æ‡§∞ ‡§π‡•Ç‡§Å</div>
        <div onclick="userFlow.role='customer'; showServiceList()" style="background:#16a34a; color:white; padding:30px; border-radius:20px; font-weight:bold; font-size:20px;">‡§Æ‡•Å‡§ù‡•á ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§ö‡§æ‡§π‡§ø‡§è</div>
    </div>`;
}

function showServiceList() {
    const srv = ['‡§°‡•á‡§Ø‡§∞‡•Ä/‡§¶‡•Ç‡§ß', '‡§ï‡§ø‡§∞‡§æ‡§®‡§æ ‡§¶‡•Å‡§ï‡§æ‡§®', '‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä', 'JCB ‡§Æ‡§∂‡•Ä‡§®', '‡§ü‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§∞', '‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•Ä‡§∂‡§ø‡§Ø‡§®', '‡§Æ‡•õ‡§¶‡•Ç‡§∞'];
    let html = `<div id="service-list-page" style="padding:15px;"><div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">`;
    srv.forEach(s => {
        html += `<div onclick="userFlow.service='${s}'; ${userFlow.role==='worker'?'showRegistrationForm()':'showList()'}" style="background:white; padding:20px; border-radius:15px; text-align:center; font-weight:bold; border-bottom:4px solid #000; box-shadow:0 4px 8px rgba(0,0,0,0.1);">${s}</div>`;
    });
    document.getElementById('app-container').innerHTML = html + `</div></div>`;
}

// 7. ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® (‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§ö‡§æ‡§∞‡•ç‡§ú ‡§ï‡•á ‡§∏‡§æ‡§•)
function showRegistrationForm() {
    let isShop = (userFlow.service === '‡§°‡•á‡§Ø‡§∞‡•Ä/‡§¶‡•Ç‡§ß' || userFlow.service === '‡§ï‡§ø‡§∞‡§æ‡§®‡§æ ‡§¶‡•Å‡§ï‡§æ‡§®');
    document.getElementById('app-container').innerHTML = `
        <div id="reg-form" style="padding:20px;">
            <div style="background:white; border-radius:20px; box-shadow:0 10px 20px rgba(0,0,0,0.1); padding:20px;">
                <h3 style="color:#2563eb;">${userFlow.service} ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§®</h3>
                <input type="text" id="wName" placeholder="‡§®‡§æ‡§Æ / ‡§¶‡•Å‡§ï‡§æ‡§® ‡§ï‡§æ ‡§®‡§æ‡§Æ" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd;">
                <input type="number" id="wPhone" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd;">
                ${isShop ? `<input type="text" id="wCharge" placeholder="‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§ö‡§æ‡§∞‡•ç‡§ú (‡§ú‡•à‡§∏‡•á ‚Çπ20)" style="width:100%; padding:15px; margin-bottom:12px; border-radius:10px; border:1px solid #ddd; background:#fff9db;">` : ''}
                <textarea id="wAreas" placeholder="‡§Ü‡§∏‡§™‡§æ‡§∏ ‡§ï‡•á ‡§ó‡§æ‡§Å‡§µ‡•ã‡§Ç ‡§ï‡•á ‡§®‡§æ‡§Æ (‡§ï‡•ã‡§Æ‡§æ , ‡§≤‡§ó‡§æ‡§ï‡§∞)" style="width:100%; height:70px; padding:12px; border-radius:10px; border:1px solid #ddd;"></textarea>
                <button onclick="finalRegister()" style="width:100%; padding:18px; background:#000; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:15px;">‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
            </div>
        </div>`;
}

function finalRegister() {
    userFlow.workerName = document.getElementById('wName').value;
    userFlow.workerPhone = document.getElementById('wPhone').value;
    userFlow.delCharge = document.getElementById('wCharge') ? document.getElementById('wCharge').value : 'NA';
    let areas = document.getElementById('wAreas').value;
    if(!userFlow.workerName || !userFlow.workerPhone) return;
    userFlow.serviceAreas = areas.split(',').map(i => i.trim().toLowerCase());
    userFlow.serviceAreas.push(userFlow.village.toLowerCase());
    db.ref('users/').push(userFlow).then(() => { alert("‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤!"); location.reload(); });
}

// 8. ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§ø‡§∏‡•ç‡§ü
function showList() {
    document.getElementById('app-container').innerHTML = `<div id="list-container" style="padding:15px;"><h3>${userFlow.service} ‡§≤‡§ø‡§∏‡•ç‡§ü</h3><div id="list-box">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div></div>`;
    db.ref('users/').once('value', snap => {
        let html = ''; let found = false;
        let v = userFlow.village.toLowerCase();
        snap.forEach(child => {
            let d = child.val();
            if(d.role === 'worker' && d.service === userFlow.service && d.serviceAreas && d.serviceAreas.includes(v)) {
                html += `<div style="background:white; padding:15px; border-radius:15px; margin-bottom:12px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 5px 10px rgba(0,0,0,0.1); border-left:6px solid #16a34a;">
                    <div><b>${d.workerName}</b><br><small>${d.delCharge!=='NA'?'üöö ‡§ö‡§æ‡§∞‡•ç‡§ú: '+d.delCharge : '‡§ó‡§æ‡§Å‡§µ: '+d.village}</small></div>
                    <a href="tel:${d.workerPhone}" style="background:#16a34a; color:white; width:45px; height:45px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none;">üìû</a>
                </div>`;
                found = true;
            }
        });
        document.getElementById('list-box').innerHTML = found ? html : "‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§";
    });
}

showStates();
</script>
