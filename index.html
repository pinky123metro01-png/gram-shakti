<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gram Shakti | Premium Web Design</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .app-card {
    background: white;
    width: 100%;
    max-width: 480px;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    animation: fadeIn 0.8s ease-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .input-field {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid #e0e0e0;
    margin-top: 10px;
    outline: none;
    transition: all 0.3s ease;
    font-size: 16px;
  }
  .input-field:focus {
    border-color: #f97316;
    box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.2);
  }
  .btn-primary {
    width: 100%;
    padding: 16px;
    background: linear-gradient(90deg, #f97316, #ea580c);
    color: white;
    border-radius: 14px;
    font-size: 18px;
    font-weight: 700;
    margin-top: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  .btn-primary:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 12px 25px rgba(249, 115, 22, 0.5);
  }
  .btn-primary:active {
    transform: translateY(0);
    box-shadow: 0 6px 15px rgba(249, 115, 22, 0.3);
  }
  .state-grid-item {
    background: #fff;
    border: 1px solid #f97316;
    color: #f97316;
    padding: 15px;
    border-radius: 12px;
    text-align: center;
    font-weight: 600;
    cursor: pointer;
    font-size: 15px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }
  .state-grid-item:hover {
    background: #fdf2e9;
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }
  .highlight-danger {
    background: #fee2e2;
    border-left: 4px solid #ef4444;
    color: #ef4444;
    padding: 10px;
    border-radius: 8px;
    margin-top: 8px;
    animation: flashRed 1s infinite alternate;
  }
  @keyframes flashRed {
    from { opacity: 0.8; }
    to { opacity: 1; transform: scale(1.01); }
  }
  .header-logo {
    font-family: 'Poppins', sans-serif;
    font-weight: 700;
    color: #f97316;
    font-size: 2.2rem;
    line-height: 1;
  }
  /* Neela G Logo Style */
  #adminLogo {
    background: #2563eb; /* Blue Color */
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
    transition: transform 0.2s;
  }
  #adminLogo:active { transform: scale(0.9); }
</style>
</head>
<body>

<div id="app-container" class="app-card">
  </div>

<div id="msgBox" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
  <div id="msgContent" class="bg-white p-8 rounded-3xl text-center w-full max-w-xs shadow-2xl"></div>
</div>

<script>
/* üî• Firebase Setup */
const firebaseConfig = {
  apiKey: "AIzaSyCuvev3-jwZwQu0_fHYyv2E2ovLny4LhRQ",
  authDomain: "gram-shakti-b135a.firebaseapp.com",
  databaseURL: "https://gram-shakti-b135a-default-rtdb.firebaseio.com",
  projectId: "gram-shakti-b135a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let userFlow = { state: "", district: "", panchayat: "", village: "" };
const badWords = ["‡§ó‡§æ‡§≤‡•Ä", "sala", "haram", "pagal", "bad", "foul", "chutiya", "bhenchod"];

// --- 1. ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ö‡§Ø‡§® ---
function showStates() {
  const states = [
    'Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh', 
    'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand', 
    'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur', 
    'Meghalaya', 'Mizoram', 'Nagaland', 'Odisha', 'Punjab', 
    'Rajasthan', 'Sikkim', 'Tamil Nadu', 'Telangana', 'Tripura', 
    'Uttar Pradesh', 'Uttarakhand', 'West Bengal'
  ];
  
  let html = `
    <div class="flex items-center justify-between mb-8">
      <div id="adminLogo">G</div>
      <h1 class="header-logo">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
      <div class="w-12"></div>
    </div>
    <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">‡§Ö‡§™‡§®‡§æ ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</h2>
    <div class="grid grid-cols-2 gap-4 h-[350px] overflow-y-auto pr-2">`;
  states.forEach(s => { html += `<div class="state-grid-item" onclick="selectState('${s}')">${s}</div>`; });
  document.getElementById("app-container").innerHTML = html + `</div>`;
  setupAdminHold();
}

function selectState(s) { userFlow.state = s; showDistrictStep(); }

function showDistrictStep() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <h2 class="text-xl font-semibold text-gray-800 mb-2">‡§ú‡§ø‡§≤‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç</h2>
    <p class="text-sm text-gray-500 mb-6">${userFlow.state}</p>
    <input id="distInp" class="input-field" placeholder="‡§ú‡§ø‡§≤‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç...">
    <button onclick="saveDistrict()" class="btn-primary">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>
  `;
}
function saveDistrict() {
  const val = document.getElementById("distInp").value.trim();
  if(!val) return showMessage('error', "‡§ú‡§ø‡§≤‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç!");
  userFlow.district = val;
  showPanchayatStep();
}

function showPanchayatStep() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <h2 class="text-xl font-semibold text-gray-800 mb-2">‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§≤‡§ø‡§ñ‡•á‡§Ç</h2>
    <p class="text-sm text-gray-500 mb-6">${userFlow.district}</p>
    <input id="panchInp" class="input-field" placeholder="‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§≤‡§ø‡§ñ‡•á‡§Ç...">
    <button onclick="savePanchayat()" class="btn-primary">‡§Ü‡§ó‡•á ‡§¨‡•ù‡•á‡§Ç</button>
  `;
}
function savePanchayat() {
  const val = document.getElementById("panchInp").value.trim();
  if(!val) return showMessage('error', "‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§≤‡§ø‡§ñ‡•á‡§Ç!");
  userFlow.panchayat = val;
  showVillageStep();
}

function showVillageStep() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <h2 class="text-xl font-semibold text-gray-800 mb-2">‡§ó‡§æ‡§Å‡§µ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç</h2>
    <input id="villInp" class="input-field" placeholder="‡§ó‡§æ‡§Å‡§µ ‡§≤‡§ø‡§ñ‡•á‡§Ç...">
    <button onclick="saveVillage()" class="btn-primary">‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
  `;
}
function saveVillage() {
  const val = document.getElementById("villInp").value.trim();
  if(!val) return showMessage('error', "‡§ó‡§æ‡§Å‡§µ ‡§≤‡§ø‡§ñ‡•á‡§Ç!");
  userFlow.village = val;
  showOptions();
}

function showOptions() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <p class="text-center text-gray-500 text-sm mb-8">${userFlow.village}, ${userFlow.panchayat}</p>
    <button onclick="showRegistration()" class="btn-primary">ü§ù ‡§Æ‡•à‡§Ç ‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§æ‡§•‡•Ä ‡§π‡•Ç‡§Å</button>
    <button onclick="showCustomerView()" class="btn-primary !bg-white !text-f97316 border border-f97316 mt-4 shadow-sm">üîç ‡§∏‡•á‡§µ‡§æ ‡§¢‡•Ç‡§Ç‡§¢‡•á‡§Ç</button>
  `;
}

function showRegistration() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <input id="wname" class="input-field" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ">
    <input id="wphone" class="input-field" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞" type="tel">
    <select id="wwork" class="input-field">
      <option value="">‡§ï‡§æ‡§Æ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
      <optgroup label="‡§≠‡§æ‡§∞‡•Ä ‡§Æ‡§∂‡•Ä‡§®‡§∞‡•Ä"><option>JCB Operator</option><option>Tractor Driver</option></optgroup>
      <optgroup label="‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä & ‡§ï‡§æ‡§∞‡•Ä‡§ó‡§∞"><option>‡§∞‡§æ‡§ú‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä</option><option>‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•Ä‡§∂‡§ø‡§Ø‡§®</option></optgroup>
      <optgroup label="‡§¶‡•Å‡§ï‡§æ‡§® & ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç"><option>‡§ï‡§ø‡§∞‡§æ‡§®‡§æ ‡§¶‡•Å‡§ï‡§æ‡§®</option><option>‡§¶‡•Ç‡§ß ‡§°‡•á‡§Ø‡§∞‡•Ä</option></optgroup>
      <optgroup label="‡§õ‡•ã‡§ü‡•Ä ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç"><option>‡§Æ‡§ú‡§¶‡•Ç‡§∞</option><option>‡§®‡§æ‡§à</option></optgroup>
    </select>
    <button onclick="saveWorker()" class="btn-primary">‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç</button>
  `;
}

function saveWorker() {
  const n = document.getElementById("wname").value.trim();
  const p = document.getElementById("wphone").value.trim();
  const w = document.getElementById("wwork").value;
  if(!n || !p || !w) return showMessage('error', "‡§™‡•Ç‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç!");

  db.ref("workers").push({
    name: n, phone: p, work: w,
    location: `${userFlow.state}/${userFlow.district}/${userFlow.panchayat}/${userFlow.village}`,
    rating: 5, comments: [], time: Date.now()
  }).then(() => {
    showMessage('success', "‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§∏‡§´‡§≤!");
    showOptions();
  });
}

function showCustomerView() {
  document.getElementById("app-container").innerHTML = `
    <h1 class="header-logo text-center mb-6">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
    <div id="workerList" class="space-y-4 max-h-[350px] overflow-y-auto pr-2">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
    <button onclick="showOptions()" class="btn-primary !bg-white !text-f97316 border border-f97316 mt-6 shadow-sm">‡§™‡•Ä‡§õ‡•á ‡§ú‡§æ‡§è‡§Å</button>
  `;
  const currentPath = `${userFlow.state}/${userFlow.district}/${userFlow.panchayat}/${userFlow.village}`;
  db.ref("workers").on("value", (snapshot) => {
    let html = "";
    snapshot.forEach((child) => {
      const w = child.val();
      if (w.location === currentPath) {
        html += `<div class="p-4 bg-white rounded-xl shadow-md border-l-4 border-f97316 flex justify-between items-center">
                   <div><p class="font-bold">${w.name}</p><p class="text-f97316 text-sm">${w.work}</p></div>
                   <a href="tel:${w.phone}" class="bg-green-500 text-white p-2 rounded-full shadow-lg">üìû</a>
                 </div>`;
      }
    });
    document.getElementById("workerList").innerHTML = html || "‡§ï‡•ã‡§à ‡§∏‡•á‡§µ‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä";
  });
}

// --- ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ (G ‡§≤‡•ã‡§ó‡•ã ‡§ï‡•á ‡§™‡•Ä‡§õ‡•á) ---
function setupAdminHold() {
  const logo = document.getElementById("adminLogo");
  let timer;
  logo.onmousedown = () => { timer = setTimeout(() => {
    let p = prompt("Master Password:");
    if(p === "Vikas0627.") showAdminPanel();
  }, 3000); };
  logo.onmouseup = () => clearTimeout(timer);
}

function showAdminPanel() {
  document.getElementById("app-container").innerHTML = `
    <div class="flex justify-between items-center mb-6 border-b pb-2">
      <h2 class="text-2xl font-bold text-red-600">‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤</h2>
      <button onclick="location.reload()" class="bg-gray-100 px-3 py-1 rounded-lg text-sm">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>
    <div id="adminWorkerList" class="space-y-4 max-h-[400px] overflow-y-auto">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
  `;
  db.ref("workers").on("value", (snap) => {
    let html = "";
    snap.forEach(child => {
      const data = child.val();
      html += `<div class="p-4 bg-white rounded-xl shadow-md border-l-4 border-f97316 flex justify-between">
                 <div><p class="font-bold">${data.name}</p><p class="text-xs text-gray-500">${data.location}</p></div>
                 <button onclick="deleteEntry('${child.key}')" class="bg-red-500 text-white px-3 py-1 rounded text-xs">Delete</button>
               </div>`;
    });
    document.getElementById("adminWorkerList").innerHTML = html || "‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à";
  });
}

function deleteEntry(id) {
  if(confirm("‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞‡•á‡§Ç?")) db.ref("workers/" + id).remove();
}

function showMessage(type, message) {
  const msgContent = document.getElementById("msgContent");
  msgContent.innerHTML = `
    <div class="text-5xl mb-4">${type === 'success' ? '‚úÖ' : '‚ùå'}</div>
    <h3 class="text-xl font-bold">${message}</h3>
    <button onclick="document.getElementById('msgBox').classList.add('hidden')" class="mt-6 bg-orange-600 text-white w-full py-2 rounded-xl">OK</button>
  `;
  document.getElementById("msgBox").classList.remove("hidden");
}

showStates();
</script>
</body>
</html>
